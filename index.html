<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Nour Eldin Waleed Muhammed — Technical Office Engineer specializing in shop drawing coordination, BIM automation, and construction analytics.">
    <meta name="theme-color" content="#080808">
    <title>Nour Eldin Waleed Muhammed — Technical Office Engineer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">

</head>
<body>

    <!-- ═══════════════════════════════════════
         NAVIGATION
    ═══════════════════════════════════════ -->
    <nav class="nav">
        <div class="nav-inner">
            <a href="#hero" class="nav-logo">NEW<span class="accent">.</span></a>
            <ul class="nav-links">
                <li><a href="#pillars">Expertise</a></li>
                <li><a href="#work">Work</a></li>
                <li><a href="#stack">Stack</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#contact" class="nav-cta">Contact</a></li>
            </ul>
        </div>
    </nav>

    <!-- ═══════════════════════════════════════
         HERO
    ═══════════════════════════════════════ -->
    <section id="hero">
        <canvas id="grid-canvas"></canvas>

        <div class="hero-inner">
            <span class="hero-label" id="typewriter"><span class="cursor"></span></span>

            <h1 class="hero-name">
                Nour Eldin <span class="slash">/</span><br>
                Waleed Muhammed
            </h1>

            <p class="hero-sub">Technical Office &middot; BIM Specialist &middot; Automation Developer</p>

            <a href="#work" class="hero-cta">View My Work &darr;</a>
        </div>

        <div class="hero-scroll">
            <div class="scroll-line"></div>
            <span>scroll</span>
        </div>
    </section>

    <!-- ═══════════════════════════════════════
         STATS
    ═══════════════════════════════════════ -->
    <section id="stats" class="stats">
        <div class="stats-inner">
            <div class="stat-item">
                <span class="stat-number">7</span>
                <span class="stat-label">Buildings</span>
            </div>
            <div class="stat-divider"></div>
            <div class="stat-item">
                <span class="stat-number">~7B</span>
                <span class="stat-label">EGP Project Value</span>
            </div>
            <div class="stat-divider"></div>
            <div class="stat-item">
                <span class="stat-number">3</span>
                <span class="stat-label">Automation Tools Built</span>
            </div>
            <div class="stat-divider"></div>
            <div class="stat-item">
                <span class="stat-number">200+</span>
                <span class="stat-label">Coordinated Drawings</span>
            </div>
        </div>
    </section>

    <!-- ═══════════════════════════════════════
         PILLARS
    ═══════════════════════════════════════ -->
    <section id="pillars" class="pillars">
        <div class="container">
            <p class="section-label">// expertise</p>
            <h2 class="section-title">Three Core Competencies</h2>
            <div class="pillars-grid">

                <!-- Pillar 1: Shop Drawing -->
                <div class="pillar-card">
                    <div class="pillar-icon">
                        <svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="3" y="3" width="30" height="30" rx="1" stroke="#00c8ff" stroke-width="1.5"/>
                            <line x1="3" y1="10" x2="33" y2="10" stroke="#00c8ff" stroke-width="1.5"/>
                            <line x1="10" y1="10" x2="10" y2="33" stroke="#00c8ff" stroke-width="1.5"/>
                            <line x1="15" y1="16" x2="28" y2="16" stroke="#00c8ff" stroke-width="1"/>
                            <line x1="15" y1="20" x2="26" y2="20" stroke="#00c8ff" stroke-width="1"/>
                            <line x1="15" y1="24" x2="23" y2="24" stroke="#00c8ff" stroke-width="1"/>
                            <rect x="15" y="27" width="13" height="4" stroke="#00c8ff" stroke-width="0.75"/>
                        </svg>
                    </div>
                    <h3 class="pillar-title">Shop Drawing<br>Coordination</h3>
                    <ul class="pillar-list">
                        <li>MEP &amp; structural clash resolution</li>
                        <li>Multi-discipline duct routing</li>
                        <li>200+ drawings across commercial towers</li>
                        <li>Full review and approval workflows</li>
                    </ul>
                    <div class="pillar-tag">AutoCAD &middot; Revit &middot; ASD</div>
                </div>

                <!-- Pillar 2: BIM Automation (Featured) -->
                <div class="pillar-card pillar-card--featured">
                    <div class="pillar-icon">
                        <svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <polyline points="14,8 7,18 14,28" stroke="#00c8ff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
                            <polyline points="22,8 29,18 22,28" stroke="#00c8ff" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
                            <line x1="20" y1="6" x2="16" y2="30" stroke="#00c8ff" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <h3 class="pillar-title">BIM Automation<br>&amp; Scripting</h3>
                    <ul class="pillar-list">
                        <li>PyRevit Python add-on development</li>
                        <li>Automated QTO with Excel export</li>
                        <li>Room finish auto-assignment scripts</li>
                        <li>Model-to-deliverable workflow automation</li>
                    </ul>
                    <div class="pillar-tag">Python &middot; PyRevit &middot; Revit API</div>
                </div>

                <!-- Pillar 3: Analytics -->
                <div class="pillar-card">
                    <div class="pillar-icon">
                        <svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="4" y="26" width="6" height="6" rx="0.5" stroke="#00c8ff" stroke-width="1.5"/>
                            <rect x="15" y="20" width="6" height="12" rx="0.5" stroke="#00c8ff" stroke-width="1.5"/>
                            <rect x="26" y="13" width="6" height="19" rx="0.5" stroke="#00c8ff" stroke-width="1.5"/>
                            <line x1="4" y1="32" x2="32" y2="32" stroke="#00c8ff" stroke-width="1"/>
                            <polyline points="7,24 18,17 29,11" stroke="#00c8ff" stroke-width="1" stroke-dasharray="2,2" fill="none"/>
                        </svg>
                    </div>
                    <h3 class="pillar-title">Technical Analytics<br>&amp; Data Reporting</h3>
                    <ul class="pillar-list">
                        <li>Power BI cost element dashboards</li>
                        <li>BOQ preparation and QTO accuracy</li>
                        <li>IPC preparation &amp; invoice auditing</li>
                        <li>Variation order documentation</li>
                    </ul>
                    <div class="pillar-tag">Power BI &middot; Excel &middot; Primavera</div>
                </div>

            </div>
        </div>
    </section>

    <!-- ═══════════════════════════════════════
         SELECTED WORK
    ═══════════════════════════════════════ -->
    <section id="work">

        <header class="work-header">
            <span class="section-label">// selected work</span>
            <div class="tabs" id="tabs">
                <button class="tab active" data-cat="shop">Shop Drawing</button>
                <button class="tab"        data-cat="analytics">Analytics</button>
                <button class="tab"        data-cat="bim">BIM Automation</button>
            </div>
        </header>

        <div class="carousel-wrap" id="carouselWrap">
            <div class="carousel-track" id="track"></div>

            <button class="arrow arrow-prev" id="prev" aria-label="Previous slide">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none"
                     stroke="currentColor" stroke-width="2.2"
                     stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="15 18 9 12 15 6"/>
                </svg>
            </button>

            <button class="arrow arrow-next" id="next" aria-label="Next slide">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none"
                     stroke="currentColor" stroke-width="2.2"
                     stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="9 18 15 12 9 6"/>
                </svg>
            </button>
        </div>

        <footer class="carousel-foot">
            <div class="dots" id="dots"></div>
            <span class="slide-counter" id="counter">01 / 01</span>
        </footer>

    </section>

    <!-- ═══════════════════════════════════════
         STACK
    ═══════════════════════════════════════ -->
    <section id="stack" class="stack">
        <div class="container">
            <p class="section-label">// tools &amp; stack</p>
            <h2 class="section-title">What I Work With</h2>
            <div class="stack-grid">
                <div class="stack-group">
                    <p class="stack-group-label">BIM &amp; CAD</p>
                    <div class="stack-items">
                        <div class="stack-item">AutoCAD</div>
                        <div class="stack-item">Revit</div>
                        <div class="stack-item">Civil 3D</div>
                    </div>
                </div>
                <div class="stack-group">
                    <p class="stack-group-label">Automation</p>
                    <div class="stack-items">
                        <div class="stack-item">Dynamo Script</div>
                        <div class="stack-item">PyRevit</div>
                        <div class="stack-item">Revit API</div>
                    </div>
                </div>
                <div class="stack-group">
                    <p class="stack-group-label">Analytics</p>
                    <div class="stack-items">
                        <div class="stack-item">Power BI</div>
                        <div class="stack-item">Excel</div>
                    </div>
                </div>
                <div class="stack-group">
                    <p class="stack-group-label">Project Management</p>
                    <div class="stack-items">
                        <div class="stack-item">Primavera P6</div>
                        <div class="stack-item">Office 365</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ═══════════════════════════════════════
         ABOUT
    ═══════════════════════════════════════ -->
    <section id="about" class="about">
        <div class="container">
            <div class="about-inner">
                <div class="about-label-col">
                    <p class="section-label">// about</p>
                    <div class="about-accent-line"></div>
                </div>
                <div class="about-text-col">
                    <p class="about-text">I'm a BIM Engineer operating at the intersection of modeling and commercial construction — using Revit-based BIM not just as a design tool, but as the data source for quantity take-offs, BOQ preparation, variation orders, and invoice verification.</p>
                    <p class="about-text">I bring model auditing, drawing control, and code compliance into the same workflow, and I build the automation layer on top: Dynamo scripts that eliminate manual bottlenecks and Power BI dashboards that turn model data into commercial reporting</p>
                    <p class="about-text">The result is BIM output that's accurate, coordinated, and execution-ready — not just visually complete.</p>
                    <div class="about-badges">
                        <span class="badge">Cairo University</span>
                        <span class="badge">Civil Engineering</span>
                        <span class="badge">Egypt &middot; MENA Region</span>
                        <span class="badge">Open to Freelance</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ═══════════════════════════════════════
         CONTACT
    ═══════════════════════════════════════ -->
    <section id="contact" class="contact">
        <div class="container">
            <p class="section-label">// contact</p>
            <h2 class="contact-title">Open to<br>Opportunities.</h2>
            <p class="contact-sub">Technical office roles, BIM automation projects,<br>and freelance engagements.</p>
            <div class="contact-links">
                <!-- REPLACE: your actual email address -->
                <a href="mailto:nooor.walid@gmail.com" class="btn-primary">Email Me</a>
                <!-- REPLACE: your LinkedIn profile URL -->
                <a href="https://www.linkedin.com/in/nour-waleed-09965a204" target="_blank" rel="noopener" class="btn-outline">LinkedIn</a>
                <!-- REPLACE: path to your CV PDF when ready -->
                <a href="Nour Eldin Waleed - CV.pdf" target="_blank" class="btn-ghost">Download CV</a>
            </div>
        </div>
    </section>

    <!-- ═══════════════════════════════════════
         FOOTER
    ═══════════════════════════════════════ -->
    <footer class="footer">
        <div class="container">
            <div class="footer-inner">
                <p class="footer-name">
                    Nour Eldin Waleed Muhammed
                    <span class="accent">&middot;</span>
                    Technical Office Engineer
                </p>
                <p class="footer-right">
                    &copy; 2026 <span class="accent">&middot;</span> Cairo, Egypt
                </p>
            </div>
        </div>
    </footer>


    <!-- ═══════════════════════════════════════
         MODAL LIGHTBOX
    ═══════════════════════════════════════ -->
    <div class="modal-backdrop" id="modalBackdrop"></div>

    <div class="modal" id="modal" role="dialog" aria-modal="true" aria-label="Project detail">
        <button class="modal-close" id="modalClose" aria-label="Close modal">&times;</button>

        <div class="modal-inner">

            <!-- Left: project details -->
            <div class="modal-left">
                <span class="modal-cat   modal-animate" id="mCat"></span>
                <h2   class="modal-title modal-animate" id="mTitle"></h2>
                <p    class="modal-desc  modal-animate" id="mDesc"></p>
                <div  class="modal-stats modal-animate" id="mStats"></div>
                <div  class="modal-tags  modal-animate" id="mTags"></div>
                <a    class="modal-pdf   modal-animate" id="mPdf" target="_blank" rel="noopener">View PDF &#8599;</a>
            </div>

            <!-- Right: photos -->
            <div class="modal-right">
                <div class="modal-photo-wrap">
                    <div class="modal-photo-main" id="mPhotoMain">
                        <span  class="modal-photo-label"   id="mPhotoLabel"></span>
                        <button class="modal-photo-arrow modal-photo-prev" id="mPhotoPrev" aria-label="Previous photo">&#8249;</button>
                        <button class="modal-photo-arrow modal-photo-next" id="mPhotoNext" aria-label="Next photo">&#8250;</button>
                        <span  class="modal-photo-counter" id="mPhotoCounter">01 / 04</span>
                    </div>
                </div>
                <div class="modal-thumbs" id="mThumbs"></div>
            </div>

        </div>
    </div>

    <script>
    /* ════════════════════════════════════════════
       CAROUSEL DATA  (real project content)
       bg: solid colour — pattern overlay added by CSS per data-cat
    ════════════════════════════════════════════ */
    const DATA = {
        shop: [
            {
                bg: '#060d1b',
                title: 'Commercial Tower Structural Shop Drawings',
                desc: 'Full shop drawings for all structural elements with BBS',
                fullDesc: 'Full MEP coordination for a 22-storey commercial tower in Cairo — routing HVAC ducts, electrical cable trays, and plumbing through structural bays across 11 occupied floors. All slab penetrations and beam clearances were pre-coordinated with the structural consultant before any RFI was raised on site.',
                stats: [
                    { value: '11',   label: 'Floors' },
                    { value: '200+', label: 'Drawings' },
                    { value: '0',    label: 'Site Clashes' }
                ],
                photos: [
                    { src: 'photos/1.png',  fit: 'cover', label: 'Coordination Plan — L4' },
                    { src: null, bg: '#071a35', fit: 'cover', label: 'HVAC Routing Detail' },
                    { src: null, bg: '#091e3d', fit: 'cover', label: 'Clash Report Extract' },
                    { src: null, bg: '#061220', fit: 'cover', label: 'Approved Submission' }
                ],
                tags: ['AutoCAD', 'Revit', 'ASD', '200+ Drawings']
            },
            {
                bg: '#071525',
                title: 'MEP Duct Routing &amp; Clash Resolution',
                desc: 'Clash-free HVAC duct paths through structural beams and slab openings, approved by MEP consultant pre-execution.',
                fullDesc: 'Designed clash-free HVAC duct paths through existing structural beams and slab openings for a mixed-use development. All routing was reviewed and signed off by the MEP consultant prior to fabrication — eliminating costly site modifications and reducing the RFI backlog to zero for this discipline package.',
                stats: [
                    { value: '3',    label: 'Disciplines' },
                    { value: '100%', label: 'Pre-approved' },
                    { value: '0',    label: 'RFIs Raised' }
                ],
                photos: [
                    { src: null, bg: '#0b1a2e', fit: 'cover', label: 'Duct Layout — Plan' },
                    { src: null, bg: '#081422', fit: 'cover', label: 'Section Through Beam' },
                    { src: null, bg: '#0d2040', fit: 'cover', label: 'Isometric View' },
                    { src: null, bg: '#09182e', fit: 'cover', label: 'Approval Stamp' }
                ],
                tags: ['AutoCAD', 'MEP Coordination', 'Clash Detection', 'ASD']
            },
            {
                bg: '#050e1c',
                title: 'Add Your Next Project Here',
                desc: 'Replace this slide with your next shop drawing project.',
                fullDesc: 'This is a placeholder for your next shop drawing project. Replace the title, description, stats, tags, and photos with your actual project content.',
                stats: [
                    { value: '—', label: 'Metric 1' },
                    { value: '—', label: 'Metric 2' }
                ],
                photos: [
                    { src: null, bg: '#0d1824', fit: 'cover', label: 'Photo 1' },
                    { src: null, bg: '#0b1520', fit: 'cover', label: 'Photo 2' },
                    { src: null, bg: '#0f1d2c', fit: 'cover', label: 'Photo 3' }
                ],
                tags: ['AutoCAD', 'Revit', 'Your Tags']
            }
        ],
        analytics: [
            {
                bg: '#040c06',
                title: 'Power BI Cost Element Dashboard',
                desc: 'Cost breakdown per building element — structural, MEP, finishes — with real-time variance tracking for commercial oversight.',
                fullDesc: 'A multi-page Power BI report breaking construction costs down by element category — structural, MEP, and architectural finishes. Includes budget vs. actual variance charts, earned value analysis, and drill-down to individual work packages. Connected directly to an Excel-based BOQ for real-time data refresh.',
                stats: [
                    { value: '5',    label: 'Report Pages' },
                    { value: '12',   label: 'Cost Categories' },
                    { value: 'Live', label: 'Data Refresh' }
                ],
                photos: [
                    { src: 'photos/str-dashboard.png', fit: 'contain', label: 'Skeletal Cost Dashboard' },
                    { src: 'photos/dashbaord.png',     fit: 'contain', label: 'Cost Breakdown by Discipline' },
                    { src: null, bg: '#081e0e', fit: 'contain', label: 'Variance Chart' },
                    { src: null, bg: '#051810', fit: 'contain', label: 'Work Package Drill' }
                ],
                tags: ['Power BI', 'Excel', 'BOQ Analytics', 'Cost Reporting']
            },
            {
                bg: '#050f09',
                title: 'IPC &amp; Payment Certificate Tracker',
                desc: 'Tracks certified vs. claimed amounts across IPC cycles, reducing invoice dispute turnaround for the commercial team.',
                fullDesc: 'Interactive Power BI tracker that maps certified vs. claimed amounts across all IPC cycles for the project. Flags disputed line items automatically, tracks consultant response times, and generates summary tables for the commercial manager\'s monthly progress review — cutting average dispute resolution time by 40%.',
                stats: [
                    { value: '8',      label: 'IPC Cycles' },
                    { value: '40%',    label: 'Dispute Cut' },
                    { value: '3 Days', label: 'Avg. Resolution' }
                ],
                photos: [
                    { src: null, bg: '#051c0e', fit: 'contain', label: 'IPC Summary Page' },
                    { src: null, bg: '#071a0c', fit: 'contain', label: 'Claimed vs Certified' },
                    { src: null, bg: '#042010', fit: 'contain', label: 'Dispute Flag View' },
                    { src: null, bg: '#06180e', fit: 'contain', label: 'Monthly Report' }
                ],
                tags: ['Power BI', 'IPC Preparation', 'Invoice Auditing', 'Excel']
            }
        ],
        bim: [
            {
                bg: '#0f0303',
                title: 'PyRevit QTO Automation Add-on',
                desc: 'Extracts quantity takeoffs from the Revit model and auto-generates formatted Excel sheets — hours of work in seconds.',
                fullDesc: 'A custom PyRevit add-on that extracts element quantities directly from the Revit model by category and type, then writes formatted quantity takeoff sheets to Excel — complete with grouped headers, subtotals, and unit conversions. Reduced QTO preparation time from two working days to under 10 minutes per model.',
                stats: [
                    { value: '10 min', label: 'Was 2 Days' },
                    { value: '3+',     label: 'Element Types' },
                    { value: '100%',   label: 'Model-Driven' }
                ],
                photos: [
                    { src: null, bg: '#180808', fit: 'contain', label: 'Add-on Interface' },
                    { src: null, bg: '#1c0606', fit: 'contain', label: 'Revit Model Input' },
                    { src: null, bg: '#200a0a', fit: 'contain', label: 'Excel Output Sheet' },
                    { src: null, bg: '#150606', fit: 'contain', label: 'QTO Summary' }
                ],
                tags: ['Python', 'PyRevit', 'Revit API', 'Excel Automation']
            },
            {
                bg: '#0c0202',
                title: 'Room Finish Auto-Assignment Script',
                desc: 'Reads room function from the Revit model and auto-assigns floor, ceiling, and wall finish types across hundreds of rooms.',
                fullDesc: 'A Revit API script that reads the Room Function parameter for every room in the model and automatically assigns the correct floor, wall, and ceiling finish types from a predefined finish schedule. Eliminated manual parameter assignment across 200+ rooms and ensured finish specifications stay consistent with the latest room schedule revision.',
                stats: [
                    { value: '200+', label: 'Rooms' },
                    { value: '3',    label: 'Finish Layers' },
                    { value: '0',    label: 'Manual Entries' }
                ],
                photos: [
                    { src: null, bg: '#1a0606', fit: 'contain', label: 'Script Interface' },
                    { src: null, bg: '#160808', fit: 'contain', label: 'Room Schedule Input' },
                    { src: null, bg: '#1e080a', fit: 'contain', label: 'Finish Assignment' },
                    { src: null, bg: '#180a0a', fit: 'contain', label: 'Output Verification' }
                ],
                tags: ['Python', 'PyRevit', 'Revit API', 'BIM Automation']
            }
        ]
    };

    /* ════════════════════════════════════════════
       CAROUSEL ENGINE
    ════════════════════════════════════════════ */
    const track     = document.getElementById('track');
    const dotsEl    = document.getElementById('dots');
    const counterEl = document.getElementById('counter');
    const prevBtn   = document.getElementById('prev');
    const nextBtn   = document.getElementById('next');

    let cat   = 'shop';
    let index = 0;

    function pad(n) { return String(n).padStart(2, '0'); }

    const carouselWrap = document.getElementById('carouselWrap');

    function doBuild(newCat) {
        cat   = newCat;
        index = 0;
        track.innerHTML  = '';
        dotsEl.innerHTML = '';

        DATA[cat].forEach((s, i) => {
            const slide = document.createElement('div');
            slide.className   = 'slide';
            slide.dataset.cat = newCat;  /* drives CSS pattern per category */
            slide.dataset.idx = i;       /* used by modal open */
            slide.innerHTML = `
                <div class="slide-bg" style="background:${s.bg};"></div>
                <div class="slide-pattern"></div>
                <div class="slide-gradient"></div>
                <div class="slide-content">
                    <h2 class="slide-title">${s.title}</h2>
                    <p  class="slide-desc">${s.desc}</p>
                    <button class="slide-view-btn" type="button">View Project &#8594;</button>
                    <div class="slide-tags">
                        ${s.tags.map(t => `<span class="slide-tag">${t}</span>`).join('')}
                    </div>
                </div>`;
            track.appendChild(slide);

            const dot = document.createElement('button');
            dot.className = 'dot' + (i === 0 ? ' active' : '');
            dot.setAttribute('aria-label', `Go to slide ${i + 1}`);
            dot.addEventListener('click', () => goTo(i));
            dotsEl.appendChild(dot);
        });

        refresh();
    }

    function build(newCat) {
        if (newCat === cat) { doBuild(newCat); return; }  /* initial load — no fade */
        /* category switch: fade out → rebuild → fade in */
        carouselWrap.classList.add('is-switching');
        setTimeout(() => {
            doBuild(newCat);
            carouselWrap.classList.remove('is-switching');
        }, 200);
    }

    function refresh() {
        const total = DATA[cat].length;
        track.style.transform = `translateX(calc(-100vw * ${index}))`;
        dotsEl.querySelectorAll('.dot').forEach((d, i) =>
            d.classList.toggle('active', i === index)
        );
        counterEl.textContent = `${pad(index + 1)} / ${pad(total)}`;
        prevBtn.disabled = index === 0;
        nextBtn.disabled = index === total - 1;
    }

    function goTo(n) {
        index = Math.max(0, Math.min(n, DATA[cat].length - 1));
        refresh();
    }

    prevBtn.addEventListener('click', () => goTo(index - 1));
    nextBtn.addEventListener('click', () => goTo(index + 1));

    document.getElementById('tabs').addEventListener('click', e => {
        const btn = e.target.closest('.tab');
        if (!btn) return;
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        btn.classList.add('active');
        build(btn.dataset.cat);
    });

    document.addEventListener('keydown', e => {
        if (modalIsOpen) {
            if (e.key === 'ArrowLeft')  lockPhoto(Math.max(0, lockedPhotoIdx - 1));
            if (e.key === 'ArrowRight') lockPhoto(Math.min(currentPhotos.length - 1, lockedPhotoIdx + 1));
            if (e.key === 'Escape')     closeModal();
            return;
        }
        if (e.key === 'ArrowLeft')  goTo(index - 1);
        if (e.key === 'ArrowRight') goTo(index + 1);
    });

    let touchStartX = 0;
    const wrap = document.getElementById('carouselWrap');
    wrap.addEventListener('touchstart', e => {
        touchStartX = e.touches[0].clientX;
    }, { passive: true });
    wrap.addEventListener('touchend', e => {
        const diff = touchStartX - e.changedTouches[0].clientX;
        if (Math.abs(diff) > 48) goTo(diff > 0 ? index + 1 : index - 1);
    }, { passive: true });

    build('shop');

    /* ════════════════════════════════════════════
       TYPEWRITER
    ════════════════════════════════════════════ */
    const typeEl  = document.getElementById('typewriter');
    const LABEL   = 'Technical Office Engineer_';
    let   charIdx = 0;

    function typeNext() {
        typeEl.innerHTML = LABEL.slice(0, charIdx) + '<span class="cursor"></span>';
        if (charIdx < LABEL.length) {
            charIdx++;
            setTimeout(typeNext, charIdx === 1 ? 900 : 55);
        }
    }
    typeNext();

    /* ════════════════════════════════════════════
       INTERACTIVE GRID CANVAS
    ════════════════════════════════════════════ */
    const canvas  = document.getElementById('grid-canvas');
    const ctx     = canvas.getContext('2d');
    const CELL    = 58;
    const R_CELLS = 3.8;

    let mx = -9999, my = -9999;
    let dirty = true;

    function resizeCanvas() {
        canvas.width  = canvas.offsetWidth;
        canvas.height = canvas.offsetHeight;
        dirty = true;
    }

    function drawFrame() {
        requestAnimationFrame(drawFrame);
        if (!dirty) return;
        dirty = false;

        const W = canvas.width;
        const H = canvas.height;
        ctx.clearRect(0, 0, W, H);

        /* static grid lines */
        ctx.beginPath();
        ctx.strokeStyle = 'rgba(255,255,255,0.045)';
        ctx.lineWidth   = 1;
        for (let x = CELL; x < W; x += CELL) {
            ctx.moveTo(x + .5, 0);
            ctx.lineTo(x + .5, H);
        }
        for (let y = CELL; y < H; y += CELL) {
            ctx.moveTo(0,  y + .5);
            ctx.lineTo(W, y + .5);
        }
        ctx.stroke();

        /* per-cell glow near cursor */
        if (mx > -100) {
            const radius = CELL * R_CELLS;
            const c0 = Math.max(0, Math.floor((mx - radius) / CELL));
            const c1 = Math.ceil((mx + radius) / CELL);
            const r0 = Math.max(0, Math.floor((my - radius) / CELL));
            const r1 = Math.ceil((my + radius) / CELL);

            for (let c = c0; c <= c1; c++) {
                for (let r = r0; r <= r1; r++) {
                    const cx   = c * CELL + CELL * .5;
                    const cy   = r * CELL + CELL * .5;
                    const dist = Math.hypot(mx - cx, my - cy);
                    const t    = Math.max(0, 1 - dist / radius);
                    if (t < 0.015) continue;

                    ctx.fillStyle = `rgba(0,200,255,${t * 0.11})`;
                    ctx.fillRect(c * CELL, r * CELL, CELL, CELL);

                    ctx.strokeStyle = `rgba(0,200,255,${t * 0.38})`;
                    ctx.lineWidth   = 1;
                    ctx.strokeRect(c * CELL + .5, r * CELL + .5, CELL - 1, CELL - 1);
                }
            }

            /* soft radial bloom */
            const g = ctx.createRadialGradient(mx, my, 0, mx, my, CELL * 2.2);
            g.addColorStop(0, 'rgba(0,200,255,0.06)');
            g.addColorStop(1, 'rgba(0,200,255,0)');
            ctx.fillStyle = g;
            ctx.fillRect(0, 0, W, H);
        }
    }

    const hero = document.getElementById('hero');
    hero.addEventListener('mousemove', e => { mx = e.clientX; my = e.clientY; dirty = true; });
    hero.addEventListener('mouseleave', () => { mx = -9999; my = -9999; dirty = true; });
    window.addEventListener('resize', resizeCanvas);

    resizeCanvas();
    drawFrame();

    /* ════════════════════════════════════════════
       MODAL ENGINE
    ════════════════════════════════════════════ */
    const modalBackdrop = document.getElementById('modalBackdrop');
    const modalEl       = document.getElementById('modal');
    const modalClose    = document.getElementById('modalClose');

    let modalIsOpen    = false;
    let lockedPhotoIdx = 0;
    let currentPhotos  = [];

    const CAT_LABELS = { shop: 'Shop Drawing', analytics: 'Analytics', bim: 'BIM Automation' };

    function openModal(catKey, projIdx) {
        const proj = DATA[catKey][projIdx];

        /* left panel */
        document.getElementById('mCat').textContent  = CAT_LABELS[catKey];
        document.getElementById('mTitle').innerHTML  = proj.title;
        document.getElementById('mDesc').textContent = proj.fullDesc;

        document.getElementById('mStats').innerHTML = proj.stats.map(s =>
            `<div class="modal-stat">
                <span class="modal-stat-value">${s.value}</span>
                <span class="modal-stat-label">${s.label}</span>
             </div>`
        ).join('');

        document.getElementById('mTags').innerHTML = proj.tags.map(t =>
            `<span class="modal-tag">${t}</span>`
        ).join('');

        const pdfEl = document.getElementById('mPdf');
        if (proj.pdf) { pdfEl.href = proj.pdf; pdfEl.style.display = ''; }
        else           { pdfEl.style.display = 'none'; }

        /* photos */
        currentPhotos  = proj.photos;
        lockedPhotoIdx = 0;
        buildModalThumbs();
        setMainPhoto(0);
        updatePhotoCounter();

        /* open */
        modalBackdrop.classList.add('is-open');
        modalEl.classList.add('is-open');
        document.body.classList.add('modal-open');
        modalIsOpen = true;

        /* stagger left-panel elements after modal finishes opening */
        const animEls = modalEl.querySelectorAll('.modal-animate');
        animEls.forEach(el => el.classList.remove('animate-in'));
        setTimeout(() => {
            animEls.forEach((el, i) => {
                setTimeout(() => el.classList.add('animate-in'), i * 60);
            });
        }, 420);
    }

    function closeModal() {
        modalBackdrop.classList.remove('is-open');
        modalEl.classList.remove('is-open');
        setTimeout(() => {
            document.body.classList.remove('modal-open');
            modalIsOpen = false;
        }, 280);
    }

    function buildModalThumbs() {
        const strip = document.getElementById('mThumbs');
        strip.innerHTML = currentPhotos.map((p, i) => {
            const isContain = p.fit === 'contain';
            const bg    = isContain ? '#0d0d0d' : (p.src ? '#0d0d0d' : p.bg);
            const inset = isContain ? '3px' : '0';
            const img = p.src
                ? `<img class="modal-thumb-img" src="${p.src}" alt="" style="object-fit:${p.fit};inset:${inset};">`
                : '';
            return `<div class="modal-thumb ${i === 0 ? 'is-locked' : ''}"
                         style="background:${bg};"
                         data-idx="${i}">
                        ${img}
                        <span>${p.label}</span>
                    </div>`;
        }).join('');

        strip.querySelectorAll('.modal-thumb').forEach(thumb => {
            const idx = parseInt(thumb.dataset.idx, 10);
            thumb.addEventListener('mouseenter', () => setMainPhoto(idx));
            thumb.addEventListener('mouseleave', () => setMainPhoto(lockedPhotoIdx));
            thumb.addEventListener('click',      () => lockPhoto(idx));
        });
    }

    function setMainPhoto(idx) {
        const photo  = currentPhotos[idx];
        const mainEl = document.getElementById('mPhotoMain');
        const imgEl  = document.getElementById('mPhotoImg');

        if (photo.src) {
            imgEl.src            = photo.src;
            imgEl.style.objectFit = photo.fit;
            imgEl.style.display  = 'block';
            mainEl.style.background = '#0d0d0d';
        } else {
            imgEl.style.display  = 'none';
            mainEl.style.background = photo.bg;
        }

        document.getElementById('mPhotoLabel').textContent = photo.label;
        updatePhotoArrows(idx);
    }

    function lockPhoto(idx) {
        lockedPhotoIdx = idx;
        document.querySelectorAll('.modal-thumb').forEach((t, i) =>
            t.classList.toggle('is-locked', i === idx)
        );
        setMainPhoto(idx);
        updatePhotoCounter();
    }

    function updatePhotoCounter() {
        document.getElementById('mPhotoCounter').textContent =
            `${pad(lockedPhotoIdx + 1)} / ${pad(currentPhotos.length)}`;
    }

    function updatePhotoArrows(activeIdx) {
        document.getElementById('mPhotoPrev').disabled = activeIdx === 0;
        document.getElementById('mPhotoNext').disabled = activeIdx === currentPhotos.length - 1;
    }

    /* photo navigation */
    document.getElementById('mPhotoPrev').addEventListener('click', () => {
        lockPhoto(Math.max(0, lockedPhotoIdx - 1));
    });
    document.getElementById('mPhotoNext').addEventListener('click', () => {
        lockPhoto(Math.min(currentPhotos.length - 1, lockedPhotoIdx + 1));
    });

    /* close triggers */
    modalClose.addEventListener('click', closeModal);
    modalBackdrop.addEventListener('click', closeModal);

    /* swipe on main photo */
    let photoTouchX = 0;
    document.getElementById('mPhotoMain').addEventListener('touchstart', e => {
        photoTouchX = e.touches[0].clientX;
    }, { passive: true });
    document.getElementById('mPhotoMain').addEventListener('touchend', e => {
        const diff = photoTouchX - e.changedTouches[0].clientX;
        if (Math.abs(diff) > 40) lockPhoto(diff > 0
            ? Math.min(currentPhotos.length - 1, lockedPhotoIdx + 1)
            : Math.max(0, lockedPhotoIdx - 1)
        );
    }, { passive: true });

    /* open modal via "View Project" button — event delegation on carousel track */
    track.addEventListener('click', e => {
        const btn = e.target.closest('.slide-view-btn');
        if (!btn) return;
        const slide = btn.closest('.slide');
        openModal(slide.dataset.cat, parseInt(slide.dataset.idx, 10));
    });
    </script>
</body>
</html>
